<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase</title>
</head>

<body>
    <ul id="miss"></ul>

    <script>
        const database = "https://singulars-2020-default-rtdb.firebaseio.com/"

        var miss = document.querySelector("#miss")
        
        // agafant diferents dades amb GET
        fetch(database + "alumnes.json")
        .then(res => res.json())
        .then(res => console.log(res))
        
        fetch(database + "llista-compra.json")
        .then(res => res.json())
        .then(res => console.log(res))
        
        // el mateix en una funció
        function get() {
            fetch(database + "missatges.json")
            .then(res => res.json())
            .then(res => {
                var missatges = res
                
                for (id in missatges) {
                    miss.innerHTML += `<li data-id="${id}" style="margin-bottom: 1em">${missatges[id].user}:<br> "${missatges[id].message}"</li>`
                }
            })
        }
        

        // -------------------------------------------
        
        
        // afegint entrades amb el mètode POST
        function send(name, text){
            fetch(database + "missatges.json", {
                method: 'POST',
                body: JSON.stringify({  "user": name,
                                        "message": text
                                    })
            })
            .then(res => res.json())
            .then(res => console.log(res));
        }
        
    
        // ---------------------------------------------


        // eliminar dades amb DELETE
        function erase(id){
            fetch(database + "missatges/" + id + ".json", {
                method: 'DELETE'
            })
            .then(res => res.json())
            .then(res => console.log(res));
        }


        // -----------------------------------------------


        // modificar dades amb el mètode PATCH
        function patch(id, obj){
            fetch(database + "missatges/" + id + ".json", {
                method: 'PATCH',
                body: JSON.stringify(obj)
            })
            .then(res => res.json())
            .then(res => console.log(res));
        }


        // -----------------------------------------------


        // sobreescriure entrades amb el mètode PUT      
        // (⚠️ sobreescriu eliminant el que hi hagi)
        function put(id, obj){
            fetch(database + "missatges/" + id + ".json", {
                method: 'PUT',
                body: JSON.stringify(obj)
            })
            .then(res => res.json())
            .then(res => console.log(res));
        }
    </script>
</body>
</html>